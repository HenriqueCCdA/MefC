/******************************Includes*******************************/
#include <Tipos_Wave.h>
#include <Extern_Wave.h>
/*********************************************************************/
/**/
/*********************Prototipos das funcoes**************************/
/*--- Proprios*/
void correct (double x[]);
void predict(void);
/*-------------------------------------------------------------------*/
/*********************************************************************/
/**/
/*********************************************************************/
void predict(void)   {
/*===*/
  long i,k;
/*===================================================================*/
/**/
/*===*/ 
  for (i=0;i<nnode;i++){
/*...*/  
    for (k=0;k<ndf;k++){
      node[i].u[k] = node[i].u[k] + dt * node[i].v[k] 
                     + dt * dt / 2 * ( 1 - 2 * beta ) * node[i].a[k];
      node[i].v[k] = node[i].v[k] + ( 1 - alfa ) * dt * node[i].a[k];
      node[i].a[k] = 0.0;
    }
/*...................................................................*/
  }
/*===================================================================*/
}
/*********************************************************************/
/**/
/*********************************************************************/
void correct ( double x[] )   {
/*===*/
  long i,k,ii;
/*===================================================================*/
/**/
/*===*/
  for (i=0;i<nnode;i++)   {
/*...*/
    for (k=0;k<ndf;k++)   {
      ii = node[i].eqn[k]; 
/*---*/
      if (ii > -1)   {
        node[i].a[k] = node[i].a[k] + x[ii];
	node[i].u[k] = node[i].u[k] + beta * dt * dt * node[i].a[k];
	node[i].v[k] = node[i].v[k] +  alfa * dt * node[i].a[k];
      }
/*-------------------------------------------------------------------*/
/**/
/*---*/
      if (node[i].eqn[k] == -1)
        node[i].u[k] = node[i].fp[k];
/*-------------------------------------------------------------------*/
    }
/*...................................................................*/
  }
/*===================================================================*/
}
/*********************************************************************/
